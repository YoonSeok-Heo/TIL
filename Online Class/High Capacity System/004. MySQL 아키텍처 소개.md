# 004. MySQL 아키텍처 소개

(3티어 아키텍처 이미지)

클라이언트와 서버 그리고 데이터베이스가 있는데 데이터베이스의 사용처를 알아보자

클라이언트는 서버에 데이터를 요청하는 것처럼 우리가 만드는 서버는 데이터베이스에 데이터를 요청하게 된다.

(서버에서 DB에 SQL을 날리는 이미지)
클라이언트는 다양한 방식(Rest API, JSON 등)의 호출을 가지고 서버에 데이터를 요청하는 것과 같이<br>
서버는 SQL을 활용해 데이터베이스의 데이터를 요청하게 된다.

MySQL입장에서는 우리가 만든 서버는 클라이언트와 같다.

----

(MySQL서버의 내부 구성요소 이미지)

## MySQL Engine

### 쿼리파서
- SQL을 파싱해서 Systax Tree를 만듬
- 이 과정에서 문법 오류 검사가 이루어짐

### 전처리기
- 쿼리파서에서 만든 Tree를 바탕으로 전처리 시작
- 테이블이나 컬럼 존재 여부, 접근권한 등 Sementic 오류 검사

#### 쿼리파서, 전처리기
- 쿼리파서, 전처리기는 컴파일 과정과 매우 유사하다
- 하지만 SQL은 프로그래밍 언어처럼 컴파일 타임때 검증 할 수 없어 매번 구문 평가를 진항하게 된다.


### 옵티마이저
- 쿼리를 처리하기 위한 여러 방법들을 만들고, 각 방법들의 비용정보와 테이블의 통계정보를 이용해 비용을 산정
- 테이블의 순서, 불필요한 조건 제거, 통계정보를 바탕으로 전략을 결정(실행 계획 수립)
- 옵티마이저가 어떤 전략을 결정하느냐에 따라 성능이 많이 달라진다.
- 가끔씩 성능이 나쁜 판단을 해 개발자가 힌트를 사용해 도움을 줄 수 있다.

### 쿼리실행기
- 옵티마이저가 결정한 계획대로 스트리지 엔진에 요청한다
- 요청 과정 중 Handler API 이용하여 스토리지 엔진에 요청한다.


## Storage Engine
- 디스크에서 데이터를 가져오거나 저장하는 역할
- MySQL 스토리지 엔진은 플러그인 형태로 Handler API만 맞춘다면 직접 구현해서 사용할 수 있다.
- InnoDB, MyIsam 등 여러개의 스토리지 엔진이 존재
- 8.0qnxjsms InnoDB 엔진이 디폴트이다.
