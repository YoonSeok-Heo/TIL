# 006. 실무에서의 정규화 비정규화에 대한 고민들

## 중복된 데이터는 반드시 정규화를 해야하는 걸까?

- 사실 실무에서 중복 데이터면 기계적으로 정규화하는 분들이 종종 있다.
- 정규화도 비용이다. 읽기 비용을 지불하고 쓰기 비용을 줄이는 것
  - 정규화를 진행하면 조인을 해야하기 때문에 읽기 비용이 지불된다.

## 정규화시 고려해야 하는 것
- 얼마나 빠르게 데이터의 최신성을 보장해야 하는가?
- 히스토리성 데이터는 오히려 정규화를 하지 않아야 한다.
  - 과거의 데이터도 가지고 있어야하기 때문에 정규화를 하지 않는다.
- 데이터 변경 주기와 조회 주기는 어떻게 되는가?
  - 변경 주기가 조회 주기보다 빈번하다면(변경 > 조회) 정규화 하는것이 좋다.
- 객체(테이블) 탐색 깊이가 얼마나 깊은가?
  - A에서 D의 정보를 찾기 위해선 3번의 join이 필요하다.
  - B테이블에서 D테이블의 값을 가진다.(join횟수가 줄어든다)
  - C의 D참조가 변경될 경우 B의 D참조도 같이 변경되어야한다.(변경 부분이 늘어나며 쓰기 횟수의 증가)
  - 쓰기와 읽기의 밸런스를 유지해야한다.
<br><br>![image](https://user-images.githubusercontent.com/113662725/214309075-39181946-9579-4b23-a965-464b16ffef19.png)


## 정규화를 하기로 했다면 읽기시 데이터를 어떻게 가져올 것인가?
- 테이블 조인을 많이 활용하는데, 이건 사실 고민해볼 문제다.
- 테이블 조인은 서로 다른 테이블의 결합도를 엄청나게 높인다.
  - 한 개의 테이블을 변경 할 때 여러 개의 테이블에서 영향을 받는다.
  - FK가 걸린경우 mysql에서는 데드락이 걸리는 경우도 있다.
- 조회시에는 성능이 좋은 별도 데이터베이스나 캐싱 등 다양한 최적화 기법을 이용할 수 있다.
  - 조회용 데이터를 별도의 DB에 쌓는것도 가능하다!(CQRS)
- 조인을 사용하게 되면, 이런 기법들을 사용하는데 제한이 있거나 더 많은 리소스가 들 수 있다.
- 읽기 쿼리 한번 더 발생되는 것은 그렇게 큰 부담이 아닐 수도 있다.
